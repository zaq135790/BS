<view class="container">
  <!-- 背景图片 -->
  <image class="background-image" src="cloud://cloud1-5g6ssvupb26437e4.636c-cloud1-5g6ssvupb26437e4-1382475723/image/bj1.jpg" mode="aspectFill"></image>
  <!-- 游戏标题 -->
  <view class="page-title">互动游戏</view>

  <!-- 两个主要游戏 -->
  <view class="game-grid">
    <view class="game-card" bindtap="startJudgeGame">
      <image src="cloud://cloud1-5g6ssvupb26437e4.636c-cloud1-5g6ssvupb26437e4-1382475723/image/game11.jpg" class="game-icon" />
      <view class="game-info">
        <text class="game-name">益害小判官</text>
        <text class="game-desc">判断昆虫是益虫还是害虫</text>
      </view>
    </view>
    <view class="game-card" bindtap="startPuzzleGame">
      <image src="cloud://cloud1-5g6ssvupb26437e4.636c-cloud1-5g6ssvupb26437e4-1382475723/image/game22.jpg" class="game-icon" />
      <view class="game-info">
        <text class="game-name">虫虫拼图</text>
        <text class="game-desc">完成昆虫图片拼图挑战</text>
      </view>
    </view>
  </view>

  <!-- 游戏统计 -->
  <view class="stats-section">
    <view class="stats-title">游戏统计</view>
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{stats.totalGames}}</text>
        <text class="stat-label">总游戏次数</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.correctRate}}%</text>
        <text class="stat-label">正确率</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.bestScore}}</text>
        <text class="stat-label">最高分</text>
      </view>
    </view>
  </view>

  <!-- 游戏记录 -->
  <view class="records-section">
    <view class="records-title">
      <text>游戏记录</text>
      <view class="refresh-icon {{refreshing ? 'rotating' : ''}}" bindtap="manualRefresh">
        <text class="refresh-icon-text">🔄</text>
      </view>
    </view>
    
    <!-- 游戏类型切换 -->
    <view class="game-tabs">
      <button class="tab-btn {{gameType === 'judge' ? 'active' : ''}}" bindtap="switchGameType" data-type="judge">
        益害判官
      </button>
      <button class="tab-btn {{gameType === 'puzzle' ? 'active' : ''}}" bindtap="switchGameType" data-type="puzzle">
        虫虫拼图
      </button>
    </view>

    <!-- 记录列表 -->
    <view wx:if="{{loading}}" class="loading">
      <text>加载中...</text>
    </view>
    
    <view wx:elif="{{gameRecords.judge.length === 0 && gameRecords.puzzle.length === 0}}" class="empty-state">
      <text class="empty-icon">🎮</text>
      <text class="empty-text">还没有游戏记录，快去玩游戏吧！</text>
    </view>
    
    <view wx:else>
      <view wx:for="{{gameRecords[gameType]}}" wx:key="id" class="record-item" bindtap="viewGameRecord" data-id="{{item.id}}" data-game-type="{{item.game_type}}">
        <view class="record-info">
          <text class="record-game">{{item.game_type}}</text>
          <text class="record-time">{{item.formattedTime}}</text>
        </view>
        <view class="record-score">{{item.score}}分</view>
      </view>
    </view>
  </view>
</view>
